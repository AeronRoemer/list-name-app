{% extends "namesapp/base.html" %} 
{% block content %} 
<div class='text-lg font-bold'> 
    <a href="{{request.user}}-all">
        Get All Past Names
    </a></div>
<form action="{% url 'namesapp:get-names' %}" method="post">
    {% csrf_token %}
    <fieldset>
        <legend><h2 class='text-3xl font-bold'>List Generation Script</h2></legend>
        {% if current_name %}<p class='text'>Starting from name: <strong>{{ current_name }}</strong>, position <strong>{{ current_line }} </strong> out of 100 possible names to search</p>{% endif %}
            <h4 class="text-lg">How many names do you want?</h4>    
            <select name="number" id="number">
                <option value="3">3</option>
                <option value="50">50</option>
                <option value="10">10</option>
                <option value="25">25</option>
                <option value="75">75</option>
                <option value="100">100</option>
            </select>
    <input type="submit" value="Submit" onclick="loading()">
    </form>
    <div id="loading-info" class="text-sm">
        <p>
            Be aware that fetching names takes some time, as the script has a delay of at least 15 seconds between searches for any given group of last names.
        </p>
        <p>
            It's best to just press once and wait. If there are errors, they'll be displayed on the next page. 
        </p>
        <p>
            <noscript>
                The script runs on the server, so if you have javascript disabled everything will work. Just <strong>wait 3-4 minutes</strong> before checking back.
            </noscript> 
        </p>
    </div>

    <div id='loading-dots'>
    </div>
    {% load static %}
<script type='text/javascript'>
const loading = () => {
        console.log(event, 'clicked')
        document.getElementById('loading-info').innerHTML = 'The script is gathering new names...please be patient'
        window.setInterval( function() {
            const dots = document.getElementById("loading-dots");
            let text = ""
            if ( dots.innerHTML.length > 3 ) {
                dots.innerHTML = ""
            }
               
            else {
                dots.innerHTML += ".";
            }
        }, 300);
    }
   
</script>
{% endblock %}
